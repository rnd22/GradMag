<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Events • SBU Grad Mag</title>
  <meta name="description" content="Upcoming workshops, socials, and BRIDGES programming from SBU GradMag." />

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=Source+Sans+Pro:wght@400;600;700&display=swap" rel="stylesheet" />

  <!-- Your site stylesheet (variables & base styles) -->
  <link rel="stylesheet" href="testthis.css" />

  <style>
    /* Calendar styles that respect your variables */
    :root{ --cal-grid-gap: 6px; }
    .page{ padding: 1.5rem 0 2rem; }
    .page h1{ font-family:'Playfair Display',serif; color: var(--accent); margin: .5rem 0 1rem; }

    .cal-wrap{ background:#fff; border:1px solid #eee; border-radius:12px; box-shadow:0 6px 18px rgba(0,0,0,.05); }
    .cal-toolbar{ display:flex; align-items:center; justify-content:space-between; gap:.75rem; padding: .75rem 1rem; border-bottom:1px solid #eee; }
    .cal-toolbar .when{ font-weight:700; color:var(--accent); letter-spacing:.2px }
    .cal-toolbar .controls{ display:flex; gap:.5rem; }
    .btn{ display:inline-flex; align-items:center; gap:.4rem; padding:.45rem .7rem; border:2px solid var(--accent); color:var(--accent); background:#fff; text-decoration:none; font-weight:700; border-radius:8px; cursor:pointer }
    .btn:hover{ background:var(--accent); color:#fff }
    .btn.ghost{ border-color:#ddd; color:#333 }
    .btn.ghost:hover{ background:#f5f5f5; color:#111 }

    .cal{ display:grid; grid-template-rows:auto 1fr; }
    .cal-daynames{ display:grid; grid-template-columns: repeat(7, 1fr); gap: var(--cal-grid-gap); padding: .6rem; color:#6b6b6b; font-weight:700; text-align:center; }
    .cal-grid{ display:grid; grid-template-columns: repeat(7, 1fr); gap: var(--cal-grid-gap); padding: .6rem; }

    .cell{ background:var(--surface); border:1px solid #eee; border-radius:10px; min-height:120px; display:flex; flex-direction:column; overflow:hidden }
    .cell.out{ opacity:.45 }
    .cell .date{ font-weight:700; font-size:.95rem; padding:.4rem .5rem; color:#333; }
    .events{ display:flex; flex-direction:column; gap:6px; padding: 0 .5rem .6rem; }
    .event{ background:#fff; border:1px solid #e8e3e2; border-left:4px solid var(--accent); border-radius:8px; padding:.35rem .5rem; font-size:.9rem; line-height:1.35 }
    .event .t{ display:block; font-weight:700; color:#020148 }
    .event .m{ color:#444 }

    /* Agenda list (accessible alt view) */
    .agenda{ margin: 1.25rem 0 0; }
    .agenda h2{ font-size:1.25rem; margin:.25rem 0 .5rem }
    .agenda ul{ list-style:none; padding:0; margin:0; display:grid; gap:.5rem }
    .agenda li{ background:#fff; border:1px solid #eee; border-radius:10px; padding:.6rem .75rem; display:flex; gap:.75rem; align-items:center }
    .agenda .badge{ background:#020148; color:#fff; border-radius:7px; padding:.15rem .5rem; font-size:.8rem; font-weight:700 }
/* keep date badge on one line */
.agenda .badge { white-space: nowrap; }


/* make the row respect the wider sidebar and avoid awkward wraps */
.agenda li { flex-wrap: nowrap; }
.agenda li > span:last-child { min-width: 0; }


    @media (max-width: 720px){
      .cell{ min-height: 100px }
      .event{ font-size:.85rem }
      .cal-toolbar{ flex-wrap:wrap }
    }

    /* ===== Side-by-side layout: Calendar (left) + Upcoming (right) ===== */
.events-layout {
  display: grid;
  grid-template-columns: minmax(0,1fr) 420px; /* wider sidebar */
  gap: 24px;
  align-items: start;
  margin-top: .75rem;
}


/* Make the Upcoming sidebar feel like a sidebar */
.events-sidebar{
  position: sticky; /* optional: keeps it in view while scrolling */
  top: 84px;        /* adjust if your header height changes */
}

/* Tweak heading spacing now that it's a sidebar */
.events-sidebar .agenda{ margin:0; }
.events-sidebar .agenda h2{ margin:0 0 .5rem; }

/* Responsive: stack on small screens */
@media (max-width: 900px){
  .events-layout{
    grid-template-columns:1fr;
  }
  .events-sidebar{
    position: static;
    top: auto;
  }
}
/* De-emphasize recurring/less important events */
.event.gbm {
  border-left-color: #bbb;       /* lighter gray instead of accent */
  color: #555;
  background: #fafafa;
}
.event.gbm .t { color: #555; }

/* Agenda list badge for GBM */
.agenda li.gbm .badge {
  background: #bbb;
  color: #fff;
}

  </style>
</head>
<body>

  <!-- Header (kept as-is from your current pages) -->
  <header>
    <div class="container nav">
      <div class="brand">
        <div class="brand-logo"></div>
        <div class="brand-title">SBU Graduate Arts &amp; Sciences Magazine</div>
      </div>
      <nav class="nav-links">
        <a href="index.html">Home</a>
        <a href="about.html">About</a>
        <a href="bridges.html">BRIDGES</a>
        <a href="publications.html">Publications</a>
        <a href="press.html">Press</a>
        <a href="submissions.html">Submissions</a>
        <a href="events.html" aria-current="page">Events</a>
      </nav>
    </div>
  </header>
<main class="page">
  <div class="container">
    <h1>Events</h1>

    <div class="events-layout">
      <!-- Left: Calendar -->
      <div>
        <div class="cal-wrap" role="region" aria-label="Events calendar">
          <div class="cal-toolbar">
            <div class="controls">
              <button class="btn ghost" id="prev">◀ Prev</button>
              <button class="btn ghost" id="today">Today</button>
              <button class="btn ghost" id="next">Next ▶</button>
            </div>
            <div class="when" id="when">Month YYYY</div>
            <div style="width:88px"></div>
          </div>

          <div class="cal">
            <div class="cal-daynames" aria-hidden="true">
              <div>Sun</div><div>Mon</div><div>Tue</div><div>Wed</div><div>Thu</div><div>Fri</div><div>Sat</div>
            </div>
            <div class="cal-grid" id="grid"></div>
          </div>
        </div>
      </div>

      <!-- Right: Upcoming -->
      <aside class="events-sidebar" aria-labelledby="agenda-title">
        <section class="agenda">
          <h2 id="agenda-title">Upcoming</h2>
          <ul id="agendaList"></ul>
        </section>
      </aside>
    </div>
  </div>
</main>


  <footer>
    <div class="container">
      <p>&copy; <span id="yr"></span> SBU Graduate Arts &amp; Sciences Magazine | Designed with care by the GradMag Team.</p>
    </div>
  </footer>

  <script>
    // —— Events source of truth (normalized) ——
    // NOTE: Months are 0-indexed in JS Date: Jan=0, Feb=1, ...
    const EVENTS = [
      { title: 'General Body Meetings', date: { y: 2025, m: 8, d: 3 }, time: '1:00–1:50 pm', location: 'SAC 330', multi: true, type: 'gbm', rule: { freq: 'WEEKLY', byday: ['WE'], until: { y: 2025, m: 11, d: 10 } } },
      { title: 'No Stupid Questions: Graduate Students Only', date: { y: 2025, m: 9, d: 15 }, time: 'TBD' },
      { title: 'CVs v. Resume', date: { y: 2025, m: 10, d: 12 }, time: '1:00–1:50 pm', location: 'SAC 303' },
      { title: 'Anatomy of a Poster', date: { y: 2026, m: 1, d: 10 }, time: 'TBD' },
      { title: 'B.R.I.D.G.E.S', date: { y: 2026, m: 1, d: 19 }, time: 'All day' },
      { title: 'Spring 2026 Magazine Release Party', date: { y: 2026, m: 4, d: 5 }, time: 'TBD' },
    ];

    // Expand simple weekly recurrence for display (basic, not full RFC5545)
    function expandRecurring(events, viewStart, viewEnd){
      const out = [];
      for(const e of events){
        if(!e.rule){ out.push(e); continue; }
        const start = new Date(e.date.y, e.date.m, e.date.d);
        const until = new Date(e.rule.until.y, e.rule.until.m, e.rule.until.d);
        const days = new Set((e.rule.byday||[]).map(d=>['SU','MO','TU','WE','TH','FR','SA'].indexOf(d)));
        const cur = new Date(Math.max(start, viewStart));
        // align to the first day in range
        cur.setHours(0,0,0,0);
        while(cur <= viewEnd){
          if(days.has(cur.getDay())){
            out.push({ ...e, date: { y: cur.getFullYear(), m: cur.getMonth(), d: cur.getDate() }, _instance: true });
          }
          cur.setDate(cur.getDate()+1);
        }
      }
      return out;
    }

    const grid = document.getElementById('grid');
    const whenEl = document.getElementById('when');
    const agendaList = document.getElementById('agendaList');

    let cursor = new Date(); // today
    cursor.setDate(1); // first of month

    function render(){
      const year = cursor.getFullYear();
      const month = cursor.getMonth();
      const firstDay = new Date(year, month, 1);
      const startDay = firstDay.getDay(); // 0=Sun
      const daysInMonth = new Date(year, month+1, 0).getDate();

      whenEl.textContent = firstDay.toLocaleDateString(undefined, { month:'long', year:'numeric' });

      // view window for recurring expansion (±45 days from month)
      const viewStart = new Date(year, month, 1 - 7);
      const viewEnd   = new Date(year, month, daysInMonth + 7);

      const expanded = expandRecurring(EVENTS, viewStart, viewEnd);
      const all = [...EVENTS.filter(e=>!e.rule), ...expanded];

      // map events by YYYY-MM-DD
      const byDay = new Map();
      function key(y,m,d){ return `${y}-${String(m+1).padStart(2,'0')}-${String(d).padStart(2,'0')}` }
      for(const e of all){
        const k = key(e.date.y, e.date.m, e.date.d);
        if(!byDay.has(k)) byDay.set(k, []);
        byDay.get(k).push(e);
      }

      // Build grid
      grid.innerHTML = '';

      // Leading blanks (prev month)
      const prevMonthDays = new Date(year, month, 0).getDate();
      for(let i=0;i<startDay;i++){
        const d = prevMonthDays - startDay + 1 + i;
        const cell = makeCell(d, true);
        grid.appendChild(cell);
      }
      // Current month
      for(let d=1; d<=daysInMonth; d++){
        const cell = makeCell(d, false, byDay.get(key(year, month, d)) || []);
        grid.appendChild(cell);
      }
      // Trailing blanks to complete rows
      const totalCells = startDay + daysInMonth;
      const trailing = (7 - (totalCells % 7)) % 7;
      for(let i=1;i<=trailing;i++){
        const cell = makeCell(i, true);
        grid.appendChild(cell);
      }

      // Agenda list (next 10 upcoming)
      const today = new Date(); today.setHours(0,0,0,0);
      const upcoming = all
        .map(e=>({ ...e, dt: new Date(e.date.y, e.date.m, e.date.d) }))
        .filter(e=> e.dt >= today)
        .sort((a,b)=> a.dt - b.dt)
        .slice(0, 10);
      agendaList.innerHTML = upcoming.map(e=>{
  const ds = e.dt.toLocaleDateString(undefined,{ weekday:'short', month:'short', day:'numeric' });
  const time = e.time ? ` • ${e.time}` : '';
  const loc  = e.location ? ` — ${e.location}` : '';
  const cls  = e.type === 'gbm' ? ' class="gbm"' : '';
  return `<li${cls}><span class="badge">${ds}</span><span><strong>${e.title}</strong>${time}${loc}</span></li>`;
}).join('');

    }

    function makeCell(day, out=false, events=[]) {
      const cell = document.createElement('div');
      cell.className = 'cell' + (out ? ' out' : '');
      const date = document.createElement('div');
      date.className = 'date';
      date.textContent = day;
      const list = document.createElement('div');
      list.className = 'events';
events.forEach(e=>{
  const el = document.createElement('div');
  el.className = 'event' + (e.type === 'gbm' ? ' gbm' : '');
  el.innerHTML = `<span class="t">${e.title}</span>` +
                 (e.time ? `<span class="m">${e.time}${e.location ? ' • ' + e.location : ''}</span>` : '');
  list.appendChild(el);
});

      cell.appendChild(date); cell.appendChild(list);
      return cell;
    }

    // Toolbar
    document.getElementById('prev').addEventListener('click', ()=>{ cursor.setMonth(cursor.getMonth()-1); render(); });
    document.getElementById('next').addEventListener('click', ()=>{ cursor.setMonth(cursor.getMonth()+1); render(); });
    document.getElementById('today').addEventListener('click', ()=>{ const t=new Date(); cursor = new Date(t.getFullYear(), t.getMonth(), 1); render(); });

    // Init
    document.getElementById('yr').textContent = new Date().getFullYear();
    render();
  </script>

</body>
</html>
 